<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>üöÄ VIAJE ASTRAL BM üöÄ</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  overflow: hidden;
  background: #000;
  font-family: 'Orbitron', monospace;
  touch-action: none;
  -webkit-user-select: none;
  user-select: none;
}

canvas { display: block; }

/* Pantalla de inicio */
#start-screen {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: radial-gradient(ellipse at center, #1a0a2e 0%, #000 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  z-index: 500;
  text-align: center;
  padding: 20px;
}

#start-screen h1 {
  font-size: 42px;
  background: linear-gradient(90deg, #ff0080, #00ffff, #ff0080);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-size: 200% 100%;
  animation: gradientMove 2s linear infinite;
  margin-bottom: 20px;
}

@keyframes gradientMove {
  0% { background-position: 0% 50%; }
  100% { background-position: 200% 50%; }
}

#start-screen .subtitle {
  color: #0ff;
  font-size: 18px;
  margin-bottom: 30px;
  text-shadow: 0 0 20px #0ff;
}

#start-btn {
  padding: 25px 70px;
  font-size: 28px;
  font-family: 'Orbitron', monospace;
  background: linear-gradient(135deg, #ff0080, #7928ca);
  border: none;
  border-radius: 50px;
  color: #fff;
  cursor: pointer;
  box-shadow: 0 0 30px rgba(255,0,128,0.5);
  transition: all 0.3s;
  animation: pulse 1.5s infinite;
}

#start-btn:hover {
  transform: scale(1.1);
  box-shadow: 0 0 60px rgba(255,0,128,0.8);
}

@keyframes pulse {
  0%, 100% { box-shadow: 0 0 30px rgba(255,0,128,0.5); }
  50% { box-shadow: 0 0 50px rgba(255,0,128,0.8); }
}

#start-screen .controls-info {
  margin-top: 40px;
  color: #666;
  font-size: 14px;
  line-height: 2;
}

#start-screen .controls-info span {
  color: #0ff;
  font-weight: bold;
}

#start-screen .sound-note {
  margin-top: 20px;
  color: #f0f;
  font-size: 14px;
  animation: blink 1s infinite;
}

@keyframes blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* HUD */
#hud {
  position: fixed;
  top: 20px;
  left: 20px;
  z-index: 100;
  color: #fff;
  text-shadow: 0 0 10px #0ff;
}

#title {
  font-size: 22px;
  font-weight: 900;
  background: linear-gradient(90deg, #ff0080, #00ffff, #ff0080);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-size: 200% 100%;
  animation: gradientMove 2s linear infinite;
  margin-bottom: 10px;
}

#speed-container { margin-top: 15px; }

#speed-label {
  font-size: 11px;
  color: #888;
  margin-bottom: 5px;
}

#speed-bar-bg {
  width: 150px;
  height: 15px;
  background: #222;
  border-radius: 10px;
  overflow: hidden;
  border: 2px solid #444;
}

#speed-bar {
  width: 0%;
  height: 100%;
  background: linear-gradient(90deg, #00ff00, #ffff00, #ff0000);
  transition: width 0.1s;
}

#speed-value {
  font-size: 18px;
  font-weight: bold;
  margin-top: 5px;
  color: #0f0;
  text-shadow: 0 0 10px #0f0;
}

#distance-info {
  margin-top: 10px;
  font-size: 11px;
  color: #f0f;
}

/* Bot√≥n sonido */
#sound-btn {
  position: fixed;
  top: 20px;
  right: 20px;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: rgba(0,0,0,0.7);
  border: 2px solid #0ff;
  color: #0ff;
  font-size: 24px;
  cursor: pointer;
  z-index: 300;
  display: flex;
  align-items: center;
  justify-content: center;
}

#sound-btn:hover {
  background: rgba(0,255,255,0.2);
  box-shadow: 0 0 20px #0ff;
}

/* INSTRUCCIONES */
#instructions {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  color: #fff;
  font-size: 14px;
  text-align: center;
  z-index: 100;
  animation: pulseOp 1s infinite;
  width: 90%;
  max-width: 400px;
}

@keyframes pulseOp {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

#instructions .box {
  padding: 15px 20px;
  background: rgba(0, 255, 255, 0.15);
  border: 2px solid #0ff;
  border-radius: 15px;
}

#instructions .desktop { display: block; }
#instructions .mobile { display: none; }

@media (max-width: 768px) {
  #instructions .desktop { display: none; }
  #instructions .mobile { display: block; }
  #title { font-size: 16px; }
  #speed-bar-bg { width: 120px; }
  #start-screen h1 { font-size: 28px; }
  #start-btn { font-size: 22px; padding: 20px 50px; }
}

/* Bot√≥n m√≥vil */
#accel-btn {
  position: fixed;
  bottom: 100px;
  left: 50%;
  transform: translateX(-50%);
  width: 130px;
  height: 130px;
  border-radius: 50%;
  background: radial-gradient(circle, #ff0066 0%, #aa0044 100%);
  border: 5px solid #fff;
  color: #fff;
  font-family: 'Orbitron', monospace;
  font-size: 14px;
  font-weight: bold;
  cursor: pointer;
  z-index: 200;
  display: none;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  box-shadow: 0 0 40px #ff0066;
}

#accel-btn:active {
  transform: translateX(-50%) scale(0.95);
  box-shadow: 0 0 60px #ff0066, inset 0 0 30px rgba(255,255,255,0.3);
}

#accel-btn .icon {
  font-size: 40px;
  margin-bottom: 5px;
}

@media (max-width: 768px) {
  #accel-btn { display: flex; }
}

body.warp { animation: screenShake 0.05s infinite; }

@keyframes screenShake {
  0%, 100% { transform: translate(0, 0); }
  25% { transform: translate(-2px, 1px); }
  50% { transform: translate(2px, -1px); }
  75% { transform: translate(-1px, -1px); }
}

#blackhole-reached {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: radial-gradient(circle, transparent 0%, #000 100%);
  display: none;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  z-index: 1000;
  padding: 20px;
  text-align: center;
}

#blackhole-reached.show {
  display: flex;
  animation: fadeIn 2s forwards;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

#blackhole-reached h1 {
  font-size: 32px;
  color: #fff;
  text-shadow: 0 0 30px #ff0080;
  margin-bottom: 20px;
}

#blackhole-reached p {
  font-size: 18px;
  color: #0ff;
}

#blackhole-reached .bm-logo {
  font-size: 80px;
  margin-top: 30px;
  animation: rotateLogo 3s linear infinite;
}

@keyframes rotateLogo {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

#vignette {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  pointer-events: none;
  z-index: 50;
  opacity: 0;
  background: radial-gradient(circle, transparent 40%, rgba(0,0,0,0.8) 100%);
  transition: opacity 0.3s;
}

body.warp #vignette { opacity: 1; }
</style>
</head>
<body>

<!-- PANTALLA DE INICIO -->
<div id="start-screen">
  <h1>üöÄ VIAJE ASTRAL BM üöÄ</h1>
  <div class="subtitle">Viaja hacia el agujero negro</div>
  <button id="start-btn">üéÆ INICIAR üéÆ</button>
  <div class="controls-info">
    <p>üíª PC: Mant√©n presionado <span>[ Z ]</span></p>
    <p>üì± M√≥vil: Mant√©n presionado el <span>BOT√ìN ROJO</span></p>
  </div>
  <div class="sound-note">üîä USA AUD√çFONOS PARA MEJOR EXPERIENCIA üéß</div>
</div>

<!-- BOT√ìN SONIDO -->
<button id="sound-btn" title="Sonido ON/OFF">üîä</button>

<div id="hud">
  <div id="title">üöÄ VIAJE ASTRAL BM üöÄ</div>
  <div id="speed-container">
    <div id="speed-label">VELOCIDAD WARP</div>
    <div id="speed-bar-bg">
      <div id="speed-bar"></div>
    </div>
    <div id="speed-value">0 km/s</div>
  </div>
  <div id="distance-info">üï≥Ô∏è Distancia: <span id="distance-val">10,000</span> km</div>
</div>

<div id="instructions">
  <div class="box">
    <div class="desktop">üî• MANT√âN <strong>[ Z ]</strong> PARA ACELERAR üî•</div>
    <div class="mobile">üî• MANT√âN EL <strong>BOT√ìN ROJO</strong> üî•</div>
  </div>
</div>

<button id="accel-btn">
  <span class="icon">üöÄ</span>
  <span>ACELERAR</span>
</button>

<div id="vignette"></div>

<div id="blackhole-reached">
  <h1>üï≥Ô∏è AGUJERO NEGRO ALCANZADO üï≥Ô∏è</h1>
  <p>BM CENTER - M√°s all√° de las estrellas</p>
  <div class="bm-logo">üèÅ</div>
</div>

<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

let width = canvas.width = window.innerWidth;
let height = canvas.height = window.innerHeight;
let centerX = width / 2;
let centerY = height / 2;

let speed = 0;
let maxSpeed = 100;
let acceleration = 2;
let deceleration = 3;
let isAccelerating = false;
let distance = 10000;
let gameWon = false;
let gameStarted = false;

// ============ AUDIO ENGINE ============
let audioCtx = null;
let masterGain = null;
let engineOsc = null;
let engineGain = null;
let bassOsc = null;
let bassGain = null;
let noiseNode = null;
let noiseGain = null;
let soundEnabled = true;

function initAudio() {
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  masterGain = audioCtx.createGain();
  masterGain.gain.value = 0.5;
  masterGain.connect(audioCtx.destination);
  
  // Motor principal (oscilador)
  engineOsc = audioCtx.createOscillator();
  engineOsc.type = 'sawtooth';
  engineOsc.frequency.value = 40;
  engineGain = audioCtx.createGain();
  engineGain.gain.value = 0;
  engineOsc.connect(engineGain);
  engineGain.connect(masterGain);
  engineOsc.start();
  
  // Bajo profundo
  bassOsc = audioCtx.createOscillator();
  bassOsc.type = 'sine';
  bassOsc.frequency.value = 30;
  bassGain = audioCtx.createGain();
  bassGain.gain.value = 0;
  bassOsc.connect(bassGain);
  bassGain.connect(masterGain);
  bassOsc.start();
  
  // Ruido espacial (viento c√≥smico)
  const bufferSize = 2 * audioCtx.sampleRate;
  const noiseBuffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
  const output = noiseBuffer.getChannelData(0);
  for (let i = 0; i < bufferSize; i++) {
    output[i] = Math.random() * 2 - 1;
  }
  
  noiseNode = audioCtx.createBufferSource();
  noiseNode.buffer = noiseBuffer;
  noiseNode.loop = true;
  
  const noiseFilter = audioCtx.createBiquadFilter();
  noiseFilter.type = 'lowpass';
  noiseFilter.frequency.value = 500;
  
  noiseGain = audioCtx.createGain();
  noiseGain.gain.value = 0;
  
  noiseNode.connect(noiseFilter);
  noiseFilter.connect(noiseGain);
  noiseGain.connect(masterGain);
  noiseNode.start();
  
  // Ambiente espacial (pad)
  const ambientOsc1 = audioCtx.createOscillator();
  const ambientOsc2 = audioCtx.createOscillator();
  ambientOsc1.type = 'sine';
  ambientOsc2.type = 'sine';
  ambientOsc1.frequency.value = 80;
  ambientOsc2.frequency.value = 120;
  
  const ambientGain = audioCtx.createGain();
  ambientGain.gain.value = 0.05;
  
  ambientOsc1.connect(ambientGain);
  ambientOsc2.connect(ambientGain);
  ambientGain.connect(masterGain);
  
  ambientOsc1.start();
  ambientOsc2.start();
}

function updateSound() {
  if (!audioCtx || !soundEnabled) return;
  
  const normalizedSpeed = speed / maxSpeed;
  
  // Motor: frecuencia y volumen aumentan con velocidad
  engineOsc.frequency.value = 40 + normalizedSpeed * 200;
  engineGain.gain.value = normalizedSpeed * 0.3;
  
  // Bajo: m√°s profundo a alta velocidad
  bassOsc.frequency.value = 30 + normalizedSpeed * 50;
  bassGain.gain.value = normalizedSpeed * 0.4;
  
  // Ruido: viento c√≥smico a alta velocidad
  noiseGain.gain.value = normalizedSpeed * 0.15;
}

function toggleSound() {
  soundEnabled = !soundEnabled;
  document.getElementById('sound-btn').textContent = soundEnabled ? 'üîä' : 'üîá';
  
  if (masterGain) {
    masterGain.gain.value = soundEnabled ? 0.5 : 0;
  }
}

document.getElementById('sound-btn').addEventListener('click', toggleSound);

// ============ ESTRELLAS ============
const stars = [];
const numStars = 800;

class Star {
  constructor() {
    this.reset();
  }
  
  reset() {
    this.x = (Math.random() - 0.5) * 2000;
    this.y = (Math.random() - 0.5) * 2000;
    this.z = Math.random() * 2000;
    this.pz = this.z;
    this.color = `hsl(${Math.random() * 60 + 180}, 80%, ${50 + Math.random() * 50}%)`;
  }
  
  update() {
    this.z -= speed * 2;
    if (this.z < 1) {
      this.reset();
      this.z = 2000;
      this.pz = this.z;
    }
  }
  
  draw() {
    const sx = (this.x / this.z) * 500 + centerX;
    const sy = (this.y / this.z) * 500 + centerY;
    const px = (this.x / this.pz) * 500 + centerX;
    const py = (this.y / this.pz) * 500 + centerY;
    
    this.pz = this.z;
    const size = (1 - this.z / 2000) * 4;
    
    if (speed > 30) {
      const gradient = ctx.createLinearGradient(px, py, sx, sy);
      gradient.addColorStop(0, 'transparent');
      gradient.addColorStop(0.5, this.color);
      gradient.addColorStop(1, '#fff');
      
      ctx.beginPath();
      ctx.moveTo(px, py);
      ctx.lineTo(sx, sy);
      ctx.strokeStyle = gradient;
      ctx.lineWidth = size;
      ctx.stroke();
    } else {
      ctx.beginPath();
      ctx.arc(sx, sy, size, 0, Math.PI * 2);
      ctx.fillStyle = this.color;
      ctx.fill();
    }
  }
}

for (let i = 0; i < numStars; i++) {
  stars.push(new Star());
}

// ============ SOL ============
let sunHue = 0;
let sunPulse = 0;

function drawSun() {
  const sunX = width - 150;
  const sunY = 120;
  const baseSize = 60 + Math.sin(sunPulse) * 15;
  
  sunHue = (sunHue + 2) % 360;
  sunPulse += 0.1;
  
  for (let i = 0; i < 12; i++) {
    const angle = (i / 12) * Math.PI * 2 + sunPulse;
    const rayLength = baseSize + 40 + Math.sin(sunPulse * 2 + i) * 25;
    
    ctx.beginPath();
    ctx.moveTo(sunX, sunY);
    ctx.lineTo(sunX + Math.cos(angle) * rayLength, sunY + Math.sin(angle) * rayLength);
    ctx.strokeStyle = `hsla(${(sunHue + i * 30) % 360}, 100%, 60%, 0.5)`;
    ctx.lineWidth = 6;
    ctx.stroke();
  }
  
  const sunGradient = ctx.createRadialGradient(sunX, sunY, 0, sunX, sunY, baseSize);
  sunGradient.addColorStop(0, `hsl(${sunHue}, 100%, 90%)`);
  sunGradient.addColorStop(0.5, `hsl(${(sunHue + 45) % 360}, 100%, 60%)`);
  sunGradient.addColorStop(1, `hsl(${(sunHue + 90) % 360}, 100%, 30%)`);
  
  ctx.beginPath();
  ctx.arc(sunX, sunY, baseSize, 0, Math.PI * 2);
  ctx.fillStyle = sunGradient;
  ctx.fill();
}

// ============ AGUJERO NEGRO ============
let blackholeRotation = 0;

function drawBlackhole() {
  const bhX = centerX;
  const bhY = centerY - 100;
  const approachFactor = 1 - (distance / 10000);
  const currentSize = 50 + approachFactor * 200;
  
  blackholeRotation += 0.02;
  
  for (let i = 0; i < 5; i++) {
    ctx.beginPath();
    ctx.ellipse(bhX, bhY, currentSize + 40 + i * 20, (currentSize + 40 + i * 20) * 0.3, blackholeRotation + i * 0.1, 0, Math.PI * 2);
    ctx.strokeStyle = `hsla(${30 + i * 10}, 100%, ${60 - i * 10}%, ${0.6 - i * 0.1})`;
    ctx.lineWidth = 8 - i;
    ctx.stroke();
  }
  
  const bhGradient = ctx.createRadialGradient(bhX, bhY, 0, bhX, bhY, currentSize);
  bhGradient.addColorStop(0, '#000');
  bhGradient.addColorStop(0.7, '#000');
  bhGradient.addColorStop(0.85, '#220022');
  bhGradient.addColorStop(1, 'transparent');
  
  ctx.beginPath();
  ctx.arc(bhX, bhY, currentSize, 0, Math.PI * 2);
  ctx.fillStyle = bhGradient;
  ctx.fill();
}

// ============ NAVE ESPACIAL ============
function drawSpaceCar() {
  const carX = centerX;
  const carY = height - 180;
  
  // Llamas
  if (speed > 5) {
    const flameLength = 20 + speed * 1.5;
    const flameGradient = ctx.createLinearGradient(carX, carY + 30, carX, carY + 30 + flameLength);
    flameGradient.addColorStop(0, '#fff');
    flameGradient.addColorStop(0.2, '#ff0');
    flameGradient.addColorStop(0.5, '#f80');
    flameGradient.addColorStop(1, 'transparent');
    
    ctx.beginPath();
    ctx.moveTo(carX - 20, carY + 30);
    ctx.lineTo(carX, carY + 30 + flameLength + Math.random() * 30);
    ctx.lineTo(carX + 20, carY + 30);
    ctx.fillStyle = flameGradient;
    ctx.fill();
  }
  
  // Cuerpo
  ctx.beginPath();
  ctx.moveTo(carX, carY - 50);
  ctx.lineTo(carX + 50, carY + 20);
  ctx.lineTo(carX + 45, carY + 35);
  ctx.lineTo(carX - 45, carY + 35);
  ctx.lineTo(carX - 50, carY + 20);
  ctx.closePath();
  
  const carGradient = ctx.createLinearGradient(carX - 50, carY, carX + 50, carY);
  carGradient.addColorStop(0, '#1a1a4a');
  carGradient.addColorStop(0.5, '#4a4a8a');
  carGradient.addColorStop(1, '#1a1a4a');
  ctx.fillStyle = carGradient;
  ctx.fill();
  ctx.strokeStyle = '#0ff';
  ctx.lineWidth = 3;
  ctx.stroke();
  
  // Ventana
  ctx.beginPath();
  ctx.ellipse(carX, carY - 15, 25, 15, 0, 0, Math.PI * 2);
  ctx.fillStyle = 'rgba(0, 255, 255, 0.4)';
  ctx.fill();
  
  // BANDERA BM
  const flagX = carX + 60;
  const flagY = carY - 60;
  const time = Date.now() / 100;
  const waveOffset = Math.sin(time) * 5;
  
  ctx.shadowColor = '#ff0000';
  ctx.shadowBlur = 40;
  
  // Asta
  ctx.beginPath();
  ctx.moveTo(carX + 50, carY - 10);
  ctx.lineTo(flagX + 5, flagY - 60);
  ctx.strokeStyle = '#fff';
  ctx.lineWidth = 4;
  ctx.stroke();
  
  // Esfera dorada
  ctx.beginPath();
  ctx.arc(flagX + 5, flagY - 65, 8, 0, Math.PI * 2);
  ctx.fillStyle = '#ffd700';
  ctx.fill();
  
  // Bandera
  ctx.beginPath();
  ctx.moveTo(flagX + 5, flagY - 60);
  ctx.quadraticCurveTo(flagX + 30 + waveOffset, flagY - 55, flagX + 80, flagY - 60 + waveOffset * 0.5);
  ctx.lineTo(flagX + 80 + waveOffset, flagY - 10 + waveOffset * 0.5);
  ctx.quadraticCurveTo(flagX + 30 + waveOffset, flagY - 5, flagX + 5, flagY - 10);
  ctx.closePath();
  
  ctx.fillStyle = '#ff0000';
  ctx.fill();
  ctx.strokeStyle = '#fff';
  ctx.lineWidth = 3;
  ctx.stroke();
  
  ctx.shadowBlur = 20;
  ctx.font = 'bold 36px Orbitron';
  ctx.textAlign = 'center';
  ctx.fillStyle = '#fff';
  ctx.fillText('BM', flagX + 45, flagY - 30);
  
  ctx.shadowBlur = 0;
}

// ============ UI ============
function updateUI() {
  document.getElementById('speed-bar').style.width = (speed / maxSpeed * 100) + '%';
  document.getElementById('speed-value').textContent = Math.floor(speed * 1000) + ' km/s';
  document.getElementById('distance-val').textContent = Math.max(0, Math.floor(distance)).toLocaleString();
  
  if (speed > 40) {
    document.body.classList.add('warp');
  } else {
    document.body.classList.remove('warp');
  }
}

// ============ LOOP PRINCIPAL ============
function animate() {
  if (gameWon) return;
  
  ctx.fillStyle = 'rgba(0, 0, 0, 0.15)';
  ctx.fillRect(0, 0, width, height);
  
  if (gameStarted) {
    if (isAccelerating) {
      speed = Math.min(speed + acceleration * 0.1, maxSpeed);
    } else {
      speed = Math.max(speed - deceleration * 0.1, 0);
    }
    
    if (speed > 0) {
      distance -= speed * 0.5;
      if (distance <= 0) {
        gameWon = true;
        document.getElementById('blackhole-reached').classList.add('show');
      }
    }
    
    updateSound();
  }
  
  drawSun();
  drawBlackhole();
  stars.forEach(s => { s.update(); s.draw(); });
  drawSpaceCar();
  updateUI();
  
  requestAnimationFrame(animate);
}

// ============ INICIO ============
document.getElementById('start-btn').addEventListener('click', () => {
  document.getElementById('start-screen').style.display = 'none';
  gameStarted = true;
  initAudio();
});

// ============ CONTROLES ============
document.addEventListener('keydown', e => { 
  if (e.key.toLowerCase() === 'z') isAccelerating = true; 
});
document.addEventListener('keyup', e => { 
  if (e.key.toLowerCase() === 'z') isAccelerating = false; 
});

const accelBtn = document.getElementById('accel-btn');
accelBtn.addEventListener('touchstart', e => { e.preventDefault(); isAccelerating = true; });
accelBtn.addEventListener('touchend', e => { e.preventDefault(); isAccelerating = false; });
accelBtn.addEventListener('mousedown', () => isAccelerating = true);
accelBtn.addEventListener('mouseup', () => isAccelerating = false);
accelBtn.addEventListener('mouseleave', () => isAccelerating = false);

window.addEventListener('resize', () => {
  width = canvas.width = window.innerWidth;
  height = canvas.height = window.innerHeight;
  centerX = width / 2;
  centerY = height / 2;
});

animate();
</script>
</body>
</html>
